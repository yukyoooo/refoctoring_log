# フィールドの移動

## 手順
1. 移動元のフィールドをカプセル化する
2. テストする
3. 移動先にフィールドを作成する
4. 静的解析を実行する
5. 移動元のオブジェクトから移動先のオブジェクトを参照できるようにする
   - 移動先への参照として、既存のフィールドやメソッドが使えるかも知れない。使えない場合は、参照用メソッドを簡単に作れるかどうかを調べる。うまくいかない場合は、移動元のオブジェクトに移動先のオブジェクトを格納する新しいフィールドを作成する必要があるかもしれない。これを恒久的な変更としてもよいが、より広範囲のリファクタリングがある程度進むまでの一時的な変更としても良い
6. 移動先のフィールドを使うようにアクセサを調整する
   - 移動先のオブジェクトが移動元のオブジェクト間で共有される場合は、移動先と移動元の両方のフィールドを更新するようにsetterを変更した上で[アサーションの導入](アサーションの導入.md)を施して矛盾する更新を検出できるようにする。矛盾する更新がないと判断できたら、移動先のフィールドを使うようにアクセサを変更する
7. テストする
8. 移動元のフィールドを削除する
9. テストする

```js
class Customer {
	get plan() {return this._plan;}
	get discountRate() {return this._discountRate;}
}
```
↓
```js
class Customer {
	get plan() {return this._plan;}
	get discountRate() {return this.plan.discountRate;}
}
```