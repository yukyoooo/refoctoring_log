# ステートメントの関数内への移動 

## 手順
1. 反復コードが移動先の関数呼び出しに隣接していない場合は、[ステートメントのスライド](ステートメントのスライド.md)を行なって隣接させる
2. 移動元の関数の呼び出し元が移動先の関数だけだった場合は、移動元の関数からコードをカットし、移動先の関数にペーストして、テストを行い、残りの手順を無視する
3. 複数の呼び出し元がある場合は、いずれかの呼び出しに対して[関数の抽出](関数の抽出.md)を行い、移動先の関数呼び出しと移動したいステートメントを抽出する。名前は一時的なものにするが、簡単にgrepできる名前にする
4. 他の全ての呼び出しを変更して、新しい関数を使うようにする。変更のたびにテストする
5. 元の呼び出しのすべてで新しい関数を使うようになったら、[関数のインライン化](関数のインライン化.md)を行なって元の関数を新しい関数に完全にインライン化し、元の関数を削除する
6. [関数名の変更](関数名の変更.md)を行なって、新しい関数の名前を元の関数と同じ名前に変更する
   - もし思いつくならば、より良い名前に変更する

```js
result.push(`<p>title: ${person.photo.title}</p>`);
result.concat(photoData(person.photo));

function photoData(aPhoto) {
	return [
		`<p>location: ${aPhoto.location}</p>`,
		`<p>date: ${aPhoto.date.toDateString()}</p>`,
	];
}
```
↓
```js
result.concat(photoData(person.photo));

function photoData(aPhoto) {
	return [
		`<p>title: ${aPhoto.title}</p>`,
		`<p>location: ${aPhoto.location}</p>`,
		`<p>date: ${aPhoto.date.toDateString()}</p>`,
	];
}
```