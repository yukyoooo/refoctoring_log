# フェーズの分離

## 手順
1. 後半となるフェーズのコードを、関数として抽出する
2. テストする
3. 抽出した関数に追加される引数として、中間データ構造を導入する
4. テストする
5. 抽出した後半のフェーズの各パラメータを確認する。それらが前半のフェーズでも使われているなら、中間データ構造へと移す。一つ移すごとにテストする
   - あるパラメータについては後半のフェーズで使うべきでないこともある。その場合は、そのパラメータを使用した結果を、中間データ構造のフィールドとして抽出する。その後、[ステータスメントの呼び出し側への移動](ステータスメントの呼び出し側への移動.md)
6. 前半のフェーズのコードの[関数の抽出](関数の抽出.md)を施し、中間データ構造を返すようにする
   - 前半のフェーズを変換オブジェクトとして抽出しても良い

```js
const orderData = orderString.split(/\s+/);
const productPrice = priceList[orderData[0].split("-")[1]];
const orderPrice = parseInt(orderData[1]) * productPrice;
```
　↓
```js
const orderRecord = parseOrder(order);
const orderPrice = price(orderRecord, priceList);

function parseOrder(aString) {
	const values = aString.split(/\s+/);
	return ({
		productID: values[0].split("-")[1],
		quantity: parseInt(values[1]),
	});
}
function price(order, priceList){
	return order.quantity * priceList[order.productID];
}
```